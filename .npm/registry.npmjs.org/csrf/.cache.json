{"_id":"csrf","_rev":"27-80cf12a0956c92c4b156ff6f9b5d3c50","name":"csrf","description":"primary logic behind csrf tokens","dist-tags":{"latest":"2.0.6"},"versions":{"0.0.1":{"name":"csrf","description":"Light-weight CSRF protection middleware with IP whitelisting","version":"0.0.1","author":{"name":"Michael Schonfeld","email":"michael@dwolla.com"},"dependencies":{"connect":"1.x","underscore":"1.3.3"},"keywords":["middleware","ipwhitelist","ip whilelist","csrf"],"repository":{"type":"git","url":"git://github.com/dwolla/node-csrf.git"},"_npmUser":{"name":"dwolla","email":"michael@dwolla.com"},"_id":"csrf@0.0.1","devDependencies":{},"optionalDependencies":{},"engines":{"node":"*"},"_engineSupported":true,"_npmVersion":"1.1.16","_nodeVersion":"v0.6.18","_defaultsLoaded":true,"dist":{"shasum":"f1eaebd39972dc57829068e8d8921af0371e2b02","tarball":"http://registry.npmjs.org/csrf/-/csrf-0.0.1.tgz"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"}],"directories":{}},"0.0.2":{"name":"csrf","description":"Light-weight CSRF protection middleware with IP whitelisting","version":"0.0.2","author":{"name":"Michael Schonfeld","email":"michael@dwolla.com"},"contributors":[{"name":"Sam Breed","email":"sam@quickleft.com","url":"http://wookiehangover.com"}],"dependencies":{"underscore":"1.3.3"},"devDependencies":{"mocha":"~1.4.2"},"keywords":["middleware","ipwhitelist","ip whilelist","csrf"],"repository":{"type":"git","url":"git://github.com/dwolla/node-csrf.git"},"main":"index.js","scripts":{"test":"mocha"},"license":"BSD","_npmUser":{"name":"dwolla","email":"michael@dwolla.com"},"_id":"csrf@0.0.2","optionalDependencies":{},"engines":{"node":"*"},"_engineSupported":true,"_npmVersion":"1.1.16","_nodeVersion":"v0.6.18","_defaultsLoaded":true,"dist":{"shasum":"64be34b7b17fed9f9bba6888e29c68e87b820506","tarball":"http://registry.npmjs.org/csrf/-/csrf-0.0.2.tgz"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"}],"directories":{}},"0.0.3":{"name":"csrf","description":"Light-weight CSRF protection middleware with IP whitelisting","version":"0.0.3","author":{"name":"Michael Schonfeld","email":"michael@dwolla.com"},"contributors":[{"name":"Sam Breed","email":"sam@quickleft.com","url":"http://wookiehangover.com"}],"dependencies":{"underscore":"1.3.3","crypto":"0.0.3"},"devDependencies":{"mocha":"~1.4.2"},"keywords":["middleware","ipwhitelist","ip whilelist","csrf"],"repository":{"type":"git","url":"git://github.com/dwolla/node-csrf.git"},"main":"index.js","scripts":{"test":"mocha"},"license":"BSD","_npmUser":{"name":"dwolla","email":"michael@dwolla.com"},"_id":"csrf@0.0.3","optionalDependencies":{},"engines":{"node":"*"},"_engineSupported":true,"_npmVersion":"1.1.16","_nodeVersion":"v0.6.18","_defaultsLoaded":true,"dist":{"shasum":"1bf10ade4bd4ff2db3a7bda2c28c4fc8c30a212e","tarball":"http://registry.npmjs.org/csrf/-/csrf-0.0.3.tgz"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"}],"directories":{}},"2.0.1":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.1","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"rndm":"~1.0.0","scmp":"0.0.3","uid-safe":"~1.0.1","base64-url":"1.0.0"},"devDependencies":{"istanbul":"0","bluebird":"2","mocha":"1"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"files":["index.js"],"gitHead":"d23024ade7607942a2236ec0ae5903396f610db0","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.1","_shasum":"d673a2efb4db7d0e6805dadd838c57e30ae0ee73","_from":".","_npmVersion":"1.4.21","_npmUser":{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"}],"dist":{"shasum":"d673a2efb4db7d0e6805dadd838c57e30ae0ee73","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.1.tgz"},"directories":{}},"2.0.2":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.2","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"rndm":"~1.0.0","scmp":"1.0.0","uid-safe":"~1.0.1","base64-url":"1.0.0"},"devDependencies":{"istanbul":"0","bluebird":"2","mocha":"~2.0.1"},"files":["LICENSE","HISTORY.md","README.md","index.js"],"engines":{"node":">= 0.8"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"gitHead":"ab8563d0d7abb004f086a0830d5466b30cd44f39","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.2","_shasum":"d8d3f1f83705b0acc5ed8995b4eadf4a921959f5","_from":".","_npmVersion":"1.4.21","_npmUser":{"name":"dougwilson","email":"doug@somethingdoug.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"dist":{"shasum":"d8d3f1f83705b0acc5ed8995b4eadf4a921959f5","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.2.tgz"},"directories":{}},"2.0.3":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.3","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"contributors":[{"name":"Douglas Christopher Wilson","email":"doug@somethingdoug.com"}],"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"base64-url":"1.1.0","rndm":"~1.1.0","scmp":"1.0.0","uid-safe":"~1.0.1"},"devDependencies":{"bluebird":"~2.5.3","istanbul":"0.3.5","mocha":"~2.1.0"},"files":["LICENSE","HISTORY.md","README.md","index.js"],"engines":{"node":">= 0.8"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"gitHead":"947966e5947c0529d3518e7fdd913bcc20617f25","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.3","_shasum":"d41a86b72976396be7d6f470a77167ae913fb64d","_from":".","_npmVersion":"1.4.28","_npmUser":{"name":"dougwilson","email":"doug@somethingdoug.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"dist":{"shasum":"d41a86b72976396be7d6f470a77167ae913fb64d","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.3.tgz"},"directories":{}},"2.0.4":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.4","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"contributors":[{"name":"Douglas Christopher Wilson","email":"doug@somethingdoug.com"}],"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"base64-url":"1.1.0","rndm":"~1.1.0","scmp":"1.0.0","uid-safe":"~1.0.2"},"devDependencies":{"bluebird":"~2.6.2","istanbul":"0.3.5","mocha":"~2.1.0"},"files":["LICENSE","HISTORY.md","README.md","index.js"],"engines":{"node":">= 0.8"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"gitHead":"1fe601b8cbcfab68a6ac5d8c7c59d8ffb91b383f","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.4","_shasum":"4366ddea0e08924aa324b4c7cf5649e413891f46","_from":".","_npmVersion":"1.4.28","_npmUser":{"name":"dougwilson","email":"doug@somethingdoug.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"dist":{"shasum":"4366ddea0e08924aa324b4c7cf5649e413891f46","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.4.tgz"},"directories":{}},"2.0.5":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.5","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"contributors":[{"name":"Douglas Christopher Wilson","email":"doug@somethingdoug.com"}],"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"base64-url":"1.2.0","rndm":"~1.1.0","scmp":"1.0.0","uid-safe":"~1.0.3"},"devDependencies":{"bluebird":"~2.9.4","istanbul":"0.3.5","mocha":"~2.1.0"},"files":["LICENSE","HISTORY.md","README.md","index.js"],"engines":{"node":">= 0.8"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"gitHead":"7b8ae40060e832400c7c0ba762cb27609c15384c","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.5","_shasum":"ffac90cf55269036d447008b47d2ef33929c0225","_from":".","_npmVersion":"1.4.28","_npmUser":{"name":"dougwilson","email":"doug@somethingdoug.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"dist":{"shasum":"ffac90cf55269036d447008b47d2ef33929c0225","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.5.tgz"},"directories":{}},"2.0.6":{"name":"csrf","description":"primary logic behind csrf tokens","version":"2.0.6","author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"contributors":[{"name":"Douglas Christopher Wilson","email":"doug@somethingdoug.com"}],"license":"MIT","repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"dependencies":{"base64-url":"1.2.1","rndm":"~1.1.0","scmp":"1.0.0","uid-safe":"~1.1.0"},"devDependencies":{"bluebird":"~2.9.4","istanbul":"0.3.5","mocha":"~2.1.0"},"files":["LICENSE","HISTORY.md","README.md","index.js"],"engines":{"node":">= 0.8"},"scripts":{"test":"mocha --reporter spec","test-cov":"istanbul cover node_modules/mocha/bin/_mocha -- --reporter dot","test-travis":"istanbul cover node_modules/mocha/bin/_mocha --report lcovonly -- --reporter dot"},"keywords":["csrf","tokens"],"gitHead":"b2f30cefab349bad642f9f8fa0e65f3a157d545b","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"homepage":"https://github.com/pillarjs/csrf","_id":"csrf@2.0.6","_shasum":"a90a9d88fc7411423cb0c5c13e901a8cc588132e","_from":".","_npmVersion":"1.4.28","_npmUser":{"name":"dougwilson","email":"doug@somethingdoug.com"},"maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"dist":{"shasum":"a90a9d88fc7411423cb0c5c13e901a8cc588132e","tarball":"http://registry.npmjs.org/csrf/-/csrf-2.0.6.tgz"},"directories":{}}},"readme":"# CSRF\n\n[![NPM Version][npm-image]][npm-url]\n[![NPM Downloads][downloads-image]][downloads-url]\n[![Node.js Version][node-image]][node-url]\n[![Build Status][travis-image]][travis-url]\n[![Test Coverage][coveralls-image]][coveralls-url]\n\nLogic behind CSRF token creation and verification.\nRead [Understanding-CSRF](https://github.com/pillarjs/understanding-csrf) for more information on CSRF.\nUse this module to create custom CSRF middleware and what not.\n\n### Install\n\n```bash\n$ npm install csrf\n```\n\n## API\n\n```js\nvar csrf = require('csrf')(options)\n\nvar secret = csrf.secretSync()\nvar token  = csrf.create(secret)\nvar valid  = csrf.verify(secret, token)\n```\n\n### Options\n\n- `secretLength: 24` - the byte length of the secret key\n- `saltLength: 8` - the string length of the salt\n- `tokensize: (secret, salt) => token` - a custom token creation function\n\n#### csrf.secret([cb])\n\nAsynchronously create a new `secret` of length `secretLength`.\nIf `cb` is not defined, a promise is returned.\nYou don't have to use this.\n\n```js\ncsrf.secret().then(function (secret) {\n\n})\n\ncsrf.secret(function (err, secret) {\n\n})\n```\n\n#### var secret = csrf.secretSync()\n\nSynchronous version of `csrf.secret()`\n\n#### var token = csrf.create(secret)\n\nCreate a CSRF token based on a `secret`.\nThis is the token you pass to clients.\n\n#### var valid = csrf.verify(secret, token)\n\nCheck whether a CSRF token is valid based on a `secret`.\nIf it's not valid, you should probably throw a `403` error.\n\n## License\n\n[MIT](LICENSE)\n\n[npm-image]: https://img.shields.io/npm/v/csrf.svg?style=flat\n[npm-url]: https://npmjs.org/package/csrf\n[node-image]: https://img.shields.io/node/v/csrf.svg?style=flat\n[node-url]: http://nodejs.org/download/\n[travis-image]: https://img.shields.io/travis/pillarjs/csrf.svg?style=flat\n[travis-url]: https://travis-ci.org/pillarjs/csrf\n[coveralls-image]: https://img.shields.io/coveralls/pillarjs/csrf.svg?style=flat\n[coveralls-url]: https://coveralls.io/r/pillarjs/csrf?branch=master\n[downloads-image]: https://img.shields.io/npm/dm/csrf.svg?style=flat\n[downloads-url]: https://npmjs.org/package/csrf\n","maintainers":[{"name":"dwolla","email":"michael@dwolla.com"},{"name":"jongleberry","email":"jonathanrichardong@gmail.com"},{"name":"dougwilson","email":"doug@somethingdoug.com"}],"time":{"modified":"2015-02-14T06:19:23.146Z","created":"2012-08-27T05:34:37.713Z","0.0.1":"2012-08-27T05:34:37.966Z","0.0.2":"2012-09-11T15:06:46.055Z","0.0.3":"2012-09-11T15:21:58.916Z","2.0.1":"2014-08-22T08:32:35.601Z","2.0.2":"2014-11-09T18:30:13.984Z","2.0.3":"2014-12-30T21:12:56.790Z","2.0.4":"2015-01-09T01:54:59.314Z","2.0.5":"2015-02-01T06:17:22.027Z","2.0.6":"2015-02-14T06:19:23.146Z"},"author":{"name":"Jonathan Ong","email":"me@jongleberry.com","url":"http://jongleberry.com"},"repository":{"type":"git","url":"https://github.com/pillarjs/csrf"},"keywords":["csrf","tokens"],"license":"MIT","readmeFilename":"README.md","homepage":"https://github.com/pillarjs/csrf","bugs":{"url":"https://github.com/pillarjs/csrf/issues"},"users":{"joakin":true,"jamescostian":true},"contributors":[{"name":"Douglas Christopher Wilson","email":"doug@somethingdoug.com"}],"_attachments":{},"_etag":"\"BK01IMUZZQF79X3HZUEUIGSEC\""}